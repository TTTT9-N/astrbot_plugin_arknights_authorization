# astrbot_plugin_arknights_authorization

明日方舟通行证盲盒互动插件（AstrBot）。

## 你关心的 4 个点（本次修复）

1. **资源目录说明更清晰**：改为“从零开始”步骤，包含目录、命名规则、示例。
2. **首次自动建目录**：插件初始化时会自动创建中文目录。
3. **手动放图后可生效**：新增 `/方舟盲盒 重载资源` 强制重扫；普通指令也会自动重扫。
4. **目录全部中文**：统一使用 `资源/数字盒`、`资源/特殊盒`、`资源/开出盲盒`。

---

## 一、从零开始（推荐）

### 1) 先查看插件实际资源路径
发送：

```text
/方舟盲盒 资源路径
```

机器人会返回三条绝对路径（不同部署环境可能不同）。

### 2) 首次加载会自动创建以下目录

```text
资源/
├─ 数字盒/
├─ 特殊盒/
└─ 开出盲盒/
```

> 说明：
> - `数字盒` / `特殊盒`：你放盲盒分类和奖品图。
> - `开出盲盒`：插件记录每次开出的图片（留档）。

### 3) 在“数字盒/特殊盒”里创建“种类目录”
例如在 `数字盒` 下创建一个种类 `num_vc17`：

```text
资源/数字盒/
└─ num_vc17/
   ├─ selection.jpg
   ├─ 1-山.png
   ├─ 2-W.jpg
   └─ 3-缪尔赛思.webp
```

### 4) 奖品文件命名规则（必须）

```text
<序号>-<名称>.<扩展名>
或
<序号>_<名称>.<扩展名>
```

- 序号：整数（用于 `/方舟盲盒 开 <序号>`）
- 名称：开奖文案显示的名称
- 扩展名：`jpg` / `jpeg` / `png` / `webp`

### 5) 刷新并检查
- 可直接发：`/方舟盲盒 重载资源`
- 再发：`/方舟盲盒 列表`

如果列表里出现你的种类 ID，说明加载成功。

---

## 二、指令

- `/方舟盲盒 注册`
- `/方舟盲盒 钱包`
- `/方舟盲盒 列表`
- `/方舟盲盒 选择 <种类ID>`
- `/方舟盲盒 开 <序号>`
- `/方舟盲盒 状态 [种类ID]`
- `/方舟盲盒 刷新 [种类ID]`
- `/方舟盲盒 重载资源`
- `/方舟盲盒 资源路径`
- `/方舟盲盒 管理员 列表|添加|移除|特殊定价`

## 三、数据持久化

- `blindbox.db`：SQLite（钱包 + 每个种类剩余池/剩余序号）
- `sessions.json`：用户会话（当前选择种类）
- `runtime_config.json`：价格、管理员等运行配置

> 重载和卸载插件不会清空以上数据。
